bufr:
  variables:
    # MetaData
    timestamp:
      datetime:
        year: "*/YEAR"
        month: "*/MNTH"
        day: "*/DAYS"
        hour: "*/HOUR"
        minute: "*/MINU"
        second: "*/SECO"

    latitude:
      query: "*/CLATH"

    longitude:
      query: "*/CLONH"

    satelliteId:
      query: "*/SAID"

    sensorId:
      query: "*/SIID[1]"

    scanLineNumber:
      query: "*/SLNM"

    fieldOfViewNumber:
      query: "*/FOVN"

    fieldOfRegardNumber:
      query: "*/FORN"

    sensorScanPosition:
      query: "*/FOVN"

    solarZenithAngle:
      query: "*/SOZA"

    solarAzimuthAngle:
      query: "*/SOLAZI"

    sensorZenithAngle:
      query: "*/SAZA"

    sensorAzimuthAngle:
      query: "*/BEARAZ"

    sensorViewAngle:
      sensorScanAngle:
        fieldOfViewNumber: "*/FORN"
        scanStart: -48.330
        scanStep: 3.3331
        sensor: cris

    cloudCoverTotal:
      query: "*/TOCC"

    cloudTopHeight:
      query: "*/HOCT"

    sensorChannelNumber:
      query: "*/CRCHNM/CHNM"

    # ObsValue
    spectralRadiance:
      query: "*/CRCHNM/SRAD"

  splits:
    satId:
      category:
        variable: satelliteId
        map:
          _224: npp
          _225: n20
          _226: n21

encoder:
#  type: netcdf

  dimensions:
    - name: Channel
      source: variables/sensorChannelNumber
      path: "*/CRCHNM"

  globals:
    - name: "platformCommonName"
      type: string
      value: "Meteorological Operational Satellite"

    - name: "platformLongDescription"
      type: string
      value: "EUMETSAT Polar System in sunsynchronous orbit"

    - name: "source"
      type: string
      value: "MTYP 021-241 IASI 1C RADIANCES (VARIABLE CHNS) (METOP)"

    - name: "sourceFiles"
      type: string
      value: "gdas.t00z.mtiasi.tm00.bufr_d"

    - name: "datetimeReference"
      type: string
      value: "2021-08-01T00:00:00Z"

    - name: "sensor"
      type: string
      value: "IASI"

    - name: "processingLevel"
      type: string
      value: "Level-1C"

    - name: "converter"
      type: string
      value: "BUFR"

  variables:

    # MetaData 
    - name: "MetaData/dateTime"
      source: variables/timestamp
      longName: "Datetime"
      units: "seconds since 1970-01-01T00:00:00Z"

    - name: "MetaData/latitude"
      source: variables/latitude
      longName: "Latitude"
      units: "degrees_north"
      range: [ -90, 90 ]

    - name: "MetaData/longitude"
      source: variables/longitude
      longName: "Longitude"
      units: "degrees_east"
      range: [ -180, 180 ]

    - name: "MetaData/satelliteIdentifier"
      source: variables/satelliteId
      longName: "Satellite Identifier"

#    - name: "MetaData/instrumentIdentifier"
#      source: variables/sensorId
#      longName: "Satellite Instrument Identifier"

    - name: "MetaData/scanLineNumber"
      source: variables/scanLineNumber
      longName: "Scan Line Number"

    - name: "MetaData/fieldOfViewNumber"
      source: variables/fieldOfViewNumber
      longName: "Field of View Number"

    - name: "MetaData/fieldOfRegardNumber"
      source: variables/fieldOfRegardNumber
      longName: "Field of Regard Number"

    - name: "MetaData/sensorScanPosition"
      source: variables/sensorScanPosition
      longName: "Sensor Scan Position"

    - name: "MetaData/solarZenithAngle"
      source: variables/solarZenithAngle
      longName: "Solar Zenith Angle"
      units: "degree"
      range: [ 0, 180 ]

    - name: "MetaData/solarAzimuthAngle"
      source: variables/solarAzimuthAngle
      longName: "Solar Azimuth Angle"
      units: "degree"
      range: [ 0, 360 ]

    - name: "MetaData/sensorZenithAngle"
      source: variables/sensorZenithAngle
      longName: "Sensor Zenith Angle"
      units: "degree"
      range: [ 0, 90 ]

    - name: "MetaData/sensorAzimuthAngle"
      source: variables/sensorAzimuthAngle
      longName: "Sensor Azimuth Angle"
      units: "degree"
      range: [ 0, 360 ]

    - name: "MetaData/sensorViewAngle"
      source: variables/sensorViewAngle
      longName: "Sensor View Angle"
      units: "degree"

    - name: "MetaData/cloudCoverTotal"
      source: variables/cloudCoverTotal
      longName: "Total Cloud Cover"

    - name: "MetaData/heightOfTopOfCloud"
      source: variables/cloudTopHeight
      longName: "Height of Top of Cloud"
      units: "m"

    - name: "MetaData/sensorChannelNumber"
      source: variables/sensorChannelNumber
      longName: "Sensor Channel Number"

#   The unit from BUFR is W m-2 sr-1 m -- this is radiance per wavenumber
#   - name: "ObsValue/spectralRadiance"
    - name: "ObsValue/radiance"
      source: variables/spectralRadiance
      longName: "CrIS Spectral Radiance"
      units: "W m-2 sr-1"
#     units: "W m-2 sr-1 m-1"
